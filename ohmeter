#include <LiquidCrystal.h>  

// === LCD CONNECTIONS === 

// RS → 12, E → 11, D4 → 5, D5 → 4, D6 → 3, D7 → 2  

LiquidCrystal lcd(12, 11, 5, 4, 3, 2);  

// === SETTINGS ===  

const int analogPin = A0;        // Voltage divider input pin  

const float Vin = 4.08;          // Actual 5V measured with multimeter  

const float R1 = 10020.0;         // Measured reference resistor (Ohms)  

const float calibrationFactor = 1.1; // Fine tune (e.g. 1.05 = +5% correction)  

// === CUSTOM OHM SYMBOL ===  

byte ohmSymbol[8] = {  

  B00000,  

  B01110,  

  B10001,  

  B10001,  

  B10001,  

  B01010,  

  B11011,  

  B00000  

};  

void setup() {  

  lcd.begin(16, 2); 

  lcd.createChar(0, ohmSymbol);  

}  

void loop() {  

  int raw = analogRead(analogPin);  
  float Vout = (raw * Vin) / 1023.0;    // Convert ADC value to voltage  
  float Rx = R1 * (Vout / (Vin - Vout));  // Calculate unknown resistance  
  float R = Rx * calibrationFactor; // Apply calibration correction  

  lcd.setCursor(0, 0);  // set the cursor of the LCD
  lcd.print("R = ");  // display "R =" ON LCD
  lcd.setCursor(4, 0);  // set cursor of the LCD

  if (R < 1000) {  // if the value of R is less than 100, do the follow commands
    lcd.print(R, 1);  // display the reading of R on LCD
    lcd.write(byte(0));  // Print Ω symbol  
  }
  else if (R < 1000000) {  // if the value of R is less than 100000, then do the following commands
    lcd.print(R / 1000.0, 2);  // display the reading of r divided by 1000 on the LCD
    lcd.print("k");  // display "k" on LCD
    lcd.write(byte(0));  //display ohms symbol
  } 
  else {  // if everything above doesn't happen, do the following commands
    lcd.print(R / 1000000.0, 2);  // display the reading of R dvided by 1000000
    lcd.print("M"); // display "M" on LCD
    lcd.write(byte(0));  //display the ohms symbol
  }  
  delay(1000);  // delay of 1 second between readings
}  
